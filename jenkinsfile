pipeline {
    agent any
    stages {
        stage('test') {
            steps {
                withEnv(['PATH+EXTRA=/usr/sbin:/usr/bin:/sbin:/bin', "GOPATH=${WORKSPACE}"]) {
                sh'''
                    ls
                    pwd
                    rm -rf go.mod go.sum
                    go get -u github.com/romberli/das
                    cd internal/app/query
                    go test -v service_test.go -test.run Service_GetConfig
                '''
                }
            }
        }
    }
}
