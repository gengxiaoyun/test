pipeline {
    agent any
    stages {
        stage('test') {
            steps {
                withEnv(['PATH+EXTRA=/usr/sbin:/usr/bin:/sbin:/bin', "GOPATH=${WORKSPACE}"]) {
                sh'''
                    ls
                    pwd
                    rm -f go.mod
                    ls
                    go mod init github.com/gengxiaoyun/test
                    go mod tidy
                    go build
                    cd internal/app/query
                    go test -v service_test.go service.go config.go query.go repository.go -test.run Service_GetConfig
                '''
                }
            }
        }
    }
}
